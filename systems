import React, { useState, useEffect } from 'react';
import { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/card';
import { Input } from '@/components/ui/input';
import { Label } from '@/components/ui/label';

const ROICalculator = () => {
  const [inputs, setInputs] = useState({
    revenue: 250000,
    hourlyRate: 150,
    teamSize: 2,
    teamHourlyRate: 30,
    hoursOnPM: 15,
    teamTimeWaste: 5,
    projectDelays: 3,
    firefighting: 10
  });

  const [results, setResults] = useState({
    pmCost: 0,
    teamWasteCost: 0,
    delaysCost: 0,
    firefightingCost: 0,
    totalAnnualLoss: 0,
    monthlyLoss: 0,
    projectedROI: 0
  });

  const calculateROI = () => {
    const pmWeeklyCost = inputs.hoursOnPM * inputs.hourlyRate;
    const teamWasteWeeklyCost = inputs.teamTimeWaste * inputs.teamHourlyRate * inputs.teamSize;
    const firefightingWeeklyCost = inputs.firefighting * inputs.hourlyRate;
    const delaysMonthlyRevenueLoss = (inputs.revenue / 12) * (inputs.projectDelays / 52);

    const pmAnnualCost = pmWeeklyCost * 52;
    const teamWasteAnnualCost = teamWasteWeeklyCost * 52;
    const delaysAnnualCost = delaysMonthlyRevenueLoss * 12;
    const firefightingAnnualCost = firefightingWeeklyCost * 52;

    const totalAnnualLoss = pmAnnualCost + teamWasteAnnualCost + delaysAnnualCost + firefightingAnnualCost;
    const monthlyLoss = totalAnnualLoss / 12;
    const projectedROI = ((totalAnnualLoss * 0.7) - 10000) / 10000 * 100;

    setResults({
      pmCost: Math.round(pmAnnualCost),
      teamWasteCost: Math.round(teamWasteAnnualCost),
      delaysCost: Math.round(delaysAnnualCost),
      firefightingCost: Math.round(firefightingAnnualCost),
      totalAnnualLoss: Math.round(totalAnnualLoss),
      monthlyLoss: Math.round(monthlyLoss),
      projectedROI: Math.round(projectedROI)
    });
  };

  useEffect(() => {
    calculateROI();
  }, [inputs]);

  const handleInputChange = (e) => {
    const { name, value } = e.target;
    setInputs(prev => ({
      ...prev,
      [name]: Number(value) || 0
    }));
  };

  return (
    <div className="bg-gray-950 p-6 rounded-lg transition-all duration-500 hover:shadow-xl" style={{ fontFamily: 'Aileron, sans-serif' }}>
      <Card className="w-full max-w-4xl mx-auto bg-gray-900 border-gray-800 transform transition-all duration-500 hover:scale-[1.01]">
        <CardHeader className="border-b border-gray-800">
          <CardTitle className="text-2xl transition-all duration-300 flex items-center gap-2" style={{
            color: 'rgb(255, 0, 170)', 
            textShadow: '0 0 8px rgba(255, 0, 170, 0.3)', 
            fontFamily: 'Aileron, sans-serif'
          }}>Systems ROI Calculator <span role="img" aria-label="graph">ðŸ“ˆ</span></CardTitle>
        </CardHeader>
        <CardContent className="p-6">
          <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div className="space-y-6">
              <h3 className="text-lg text-gray-100" style={{ fontFamily: 'Aileron, sans-serif' }}>Your Current Metrics</h3>
              
              <div className="space-y-4">
                <div>
                  <Label htmlFor="revenue" className="text-gray-300" style={{ fontFamily: 'Aileron, sans-serif' }}>Annual Revenue ($)</Label>
                  <Input
                    type="number"
                    id="revenue"
                    name="revenue"
                    value={inputs.revenue}
                    onChange={handleInputChange}
                    className="mt-1 bg-gray-800 border-gray-700 text-gray-100 focus:ring-gray-600 focus:border-gray-600 transition-all duration-300 focus:scale-105 hover:border-pink-500"
                    style={{ fontFamily: 'Aileron, sans-serif' }}
                  />
                </div>

                <div>
                  <Label htmlFor="hourlyRate" className="text-gray-300" style={{ fontFamily: 'Aileron, sans-serif' }}>Your Hourly Rate ($)</Label>
                  <Input
                    type="number"
                    id="hourlyRate"
                    name="hourlyRate"
                    value={inputs.hourlyRate}
                    onChange={handleInputChange}
                    className="mt-1 bg-gray-800 border-gray-700 text-gray-100 focus:ring-gray-600 focus:border-gray-600"
                    style={{ fontFamily: 'Aileron, sans-serif' }}
                  />
                </div>

                <div>
                  <Label htmlFor="teamSize" className="text-gray-300" style={{ fontFamily: 'Aileron, sans-serif' }}>Team Size (excluding you)</Label>
                  <Input
                    type="number"
                    id="teamSize"
                    name="teamSize"
                    value={inputs.teamSize}
                    onChange={handleInputChange}
                    className="mt-1 bg-gray-800 border-gray-700 text-gray-100 focus:ring-gray-600 focus:border-gray-600"
                    style={{ fontFamily: 'Aileron, sans-serif' }}
                  />
                </div>

                <div>
                  <Label htmlFor="teamHourlyRate" className="text-gray-300" style={{ fontFamily: 'Aileron, sans-serif' }}>Avg Team Hourly Rate ($)</Label>
                  <Input
                    type="number"
                    id="teamHourlyRate"
                    name="teamHourlyRate"
                    value={inputs.teamHourlyRate}
                    onChange={handleInputChange}
                    className="mt-1 bg-gray-800 border-gray-700 text-gray-100 focus:ring-gray-600 focus:border-gray-600"
                    style={{ fontFamily: 'Aileron, sans-serif' }}
                  />
                </div>

                <div>
                  <Label htmlFor="hoursOnPM" className="text-gray-300" style={{ fontFamily: 'Aileron, sans-serif' }}>Hours Spent on PM Weekly</Label>
                  <Input
                    type="number"
                    id="hoursOnPM"
                    name="hoursOnPM"
                    value={inputs.hoursOnPM}
                    onChange={handleInputChange}
                    className="mt-1 bg-gray-800 border-gray-700 text-gray-100 focus:ring-gray-600 focus:border-gray-600"
                    style={{ fontFamily: 'Aileron, sans-serif' }}
                  />
                </div>

                <div>
                  <Label htmlFor="teamTimeWaste" className="text-gray-300" style={{ fontFamily: 'Aileron, sans-serif' }}>Team Hours Wasted Weekly (per person)</Label>
                  <Input
                    type="number"
                    id="teamTimeWaste"
                    name="teamTimeWaste"
                    value={inputs.teamTimeWaste}
                    onChange={handleInputChange}
                    className="mt-1 bg-gray-800 border-gray-700 text-gray-100 focus:ring-gray-600 focus:border-gray-600"
                    style={{ fontFamily: 'Aileron, sans-serif' }}
                  />
                </div>

                <div>
                  <Label htmlFor="projectDelays" className="text-gray-300" style={{ fontFamily: 'Aileron, sans-serif' }}>Average Project Delays (weeks)</Label>
                  <Input
                    type="number"
                    id="projectDelays"
                    name="projectDelays"
                    value={inputs.projectDelays}
                    onChange={handleInputChange}
                    className="mt-1 bg-gray-800 border-gray-700 text-gray-100 focus:ring-gray-600 focus:border-gray-600"
                    style={{ fontFamily: 'Aileron, sans-serif' }}
                  />
                </div>

                <div>
                  <Label htmlFor="firefighting" className="text-gray-300" style={{ fontFamily: 'Aileron, sans-serif' }}>Hours Spent Firefighting Weekly</Label>
                  <Input
                    type="number"
                    id="firefighting"
                    name="firefighting"
                    value={inputs.firefighting}
                    onChange={handleInputChange}
                    className="mt-1 bg-gray-800 border-gray-700 text-gray-100 focus:ring-gray-600 focus:border-gray-600"
                    style={{ fontFamily: 'Aileron, sans-serif' }}
                  />
                </div>
              </div>
            </div>

            <div className="space-y-6">
              <h3 className="text-lg text-gray-100" style={{ fontFamily: 'Aileron, sans-serif' }}>Your Results</h3>
              
              <div className="space-y-4 bg-gray-800 p-6 rounded-lg border border-gray-700">
                <div>
                  <p className="text-sm text-gray-400" style={{ fontFamily: 'Aileron, sans-serif' }}>Annual Cost of PM Time</p>
                  <p className="text-xl text-gray-100" style={{ fontFamily: 'Aileron, sans-serif' }}>${results.pmCost.toLocaleString()}</p>
                </div>

                <div>
                  <p className="text-sm text-gray-400" style={{ fontFamily: 'Aileron, sans-serif' }}>Annual Cost of Team Time Waste</p>
                  <p className="text-xl text-gray-100" style={{ fontFamily: 'Aileron, sans-serif' }}>${results.teamWasteCost.toLocaleString()}</p>
                </div>

                <div>
                  <p className="text-sm text-gray-400" style={{ fontFamily: 'Aileron, sans-serif' }}>Annual Cost of Project Delays</p>
                  <p className="text-xl text-gray-100" style={{ fontFamily: 'Aileron, sans-serif' }}>${results.delaysCost.toLocaleString()}</p>
                </div>

                <div>
                  <p className="text-sm text-gray-400" style={{ fontFamily: 'Aileron, sans-serif' }}>Annual Cost of Firefighting</p>
                  <p className="text-xl text-gray-100" style={{ fontFamily: 'Aileron, sans-serif' }}>${results.firefightingCost.toLocaleString()}</p>
                </div>

                <div className="pt-4 border-t border-gray-700">
                  <p className="text-sm text-gray-400 transition-all duration-300" style={{ fontFamily: 'Aileron, sans-serif' }}>Total Annual Loss</p>
                  <div className="flex items-center gap-2">
                    <p className="text-2xl text-red-400 transition-all duration-300 hover:scale-105" style={{ fontFamily: 'Aileron, sans-serif' }}>${results.totalAnnualLoss.toLocaleString()}</p>
                  </div>
                </div>

                <div>
                  <p className="text-sm text-gray-400 transition-all duration-300" style={{ fontFamily: 'Aileron, sans-serif' }}>Monthly Loss</p>
                  <div className="flex items-center gap-2">
                    <p className="text-2xl text-red-400 transition-all duration-300 hover:scale-105" style={{ fontFamily: 'Aileron, sans-serif' }}>${results.monthlyLoss.toLocaleString()}</p>
                  </div>
                </div>

                <div className="pt-4 border-t border-gray-700">
                  <p className="text-sm text-gray-400 transition-all duration-300" style={{ fontFamily: 'Aileron, sans-serif' }}>Projected 12-Month ROI</p>
                  <div className="flex items-center gap-2">
                    <p className="text-2xl text-green-400 transition-all duration-300 hover:scale-105" style={{ fontFamily: 'Aileron, sans-serif' }}>{results.projectedROI}%</p>
                    {results.projectedROI > 0 && (
                      <span className="text-2xl animate-bounce" role="img" aria-label="roi-indicator">
                        {results.projectedROI > 500 ? 'ðŸš€' : results.projectedROI > 300 ? 'â­' : results.projectedROI > 100 ? 'ðŸ“ˆ' : 'âœ¨'}
                      </span>
                    )}
                  </div>
                  <p className="text-xs text-gray-500 mt-1 transition-all duration-300" style={{ fontFamily: 'Aileron, sans-serif' }}>Based on 70% improvement and $10,000 investment</p>
                </div>
              </div>
            </div>
          </div>
        </CardContent>
      </Card>
    </div>
  );
};

export default ROICalculator;
